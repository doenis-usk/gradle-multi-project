# Gradle DSL
以下のbuild.gradleを例にDSLについて整理する

```
apply plugin: 'application'
apply plugin: 'eclipse'

mainClassName = 'sample.Main'

repositories {
    mavenCentral()
}

dependencies {
    compile 'org.apache.commons:commons-lang3:3.3.2'
    testCompile('junit:junit:4.11') {
        transitive = false
    }
}

startScripts.applicationName = 'sample'

eclipse {
    project {
        name = 'SampleProject'
    }
}
```

```
/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */

// 参考 : https://qiita.com/opengl-8080/items/a0bb31fb20cb6505188b

// 名前付き引数
// apply(plugin: 'application')
apply plugin: 'application'
apply plugin: 'eclipse'

// イコール代入
// mainClassNameというプロパティに代入している
mainClassName = 'sample.Main'

repositories {
    mavenCentral()
}

dependencies {
    // メソッド呼び出し
    // compile('org.apache.commons:commons-lang3:3.3.2')とおなじ
    // groovyではメソッド呼び出しの丸括弧は省略できる
    // ただし、引数なしは省略できない
    compile 'org.apache.commons:commons-lang3:3.3.2'

    // メソッド引数の最後がクロージャーの場合、丸括弧の外に記述できる
    // testCompile('junit:junit:4.11', { transitive = false })
    testCompile('junit:junit:4.11') {
        transitive = false
    }
}

// イコール代入
// startScriptsオブジェクトのapplicationNameというプロパティに代入している
startScripts.applicationName = 'sample'

// スクリプトブロック (クロージャーが引数メソッド呼び出し)
//　クロージャーは任意のコードを記述できるブロック要素
//
// def projectClosure = {name = 'SampleProject'}
// def eclipseClosure = {project(projectClosure)}
// eclipse(eclipseClosure)
//
// クロージャー内では、delegate変数に設定されているオブジェクトのプロパティやメソッドが暗黙的に参照できる
// println delegate.class で変数を表示できる
//
// スクリプトブロックとドット区切り記法は書き換え可能
// eclipse.project.name = 'SampleProject'
eclipse {
    project {
        name = 'SampleProject'
    }
}

// task('hello', {})
// 構文木を書き換えているらしい
// https://stackoverflow.com/questions/27584463/understanding-the-groovy-syntax-in-a-gradle-task-definition/27584555#27584555
task hello {
    println name + ": configuring task hello"
    doLast {
        println name + ": hello there"
    }
}

// Gradle5系では<<(leftShift)は使えなくなり、doLastを使うことになる
task hello2 {
    doLast {
        println name + ': Hello Gradle world!'
    }
}
```

# Gradle Link
- [Command Line Interface](https://docs.gradle.org/5.6.2/userguide/command_line_interface.html)
- [Plugins](https://docs.gradle.org/current/userguide/plugins.html)
